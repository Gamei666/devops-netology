Данный Playbook устанавливает ClickHouse, Vector+Nginx и Lighthouse на соответствующие группы хостов. Поддерживаются только debian-based дистрибутивы.
Основные переменные, которые необходимо заполнить - user и password в secrets.yml эти данные будут использоваться для создания пользователя БД в Clickhouse и clickhouse_addr - адрес машины, на которую будет установлен Clickhouse.
Этапы работы Playbook:
1. Установка через пакетный менеджер apt Clickhouse-Server на целевую машину, конфигурация ip на котором будет слушать сервер с помощью template-file clickhouse-server.j2 и создание БД, Таблицы, пользователя с помощью команд clickhouse-client
2. Установка Nginx (c помощью apt) на целевую машину с Vector для того, чтобы легко генерировать простые логи для тестирования работоспособности путём подключения через браузер/использования curl.
3. Установка Vector (путём скачивания dep-пакета с официального сайта) и конфигурация его через template-file vector.j2
4. Установка Nginx на хост с Lighthouse и установка последнего путём скачивания git-репозитория, затем конфигурация Nginx с помощью template-file nginx.j2 для работы веб-интерфейса.
